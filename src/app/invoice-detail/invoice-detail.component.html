<div class="invoice-detail">
    <header>
        <div class="adress-window">
            <div class="postage-info">
                SednaSoft GbR, Biesnitzer Straße 8, 02826 Görlitz
            </div><!-- class="postage-info" -->
            <select [(ngModel)]="invoiceSelectCustomer" (ngModelChange)="changeFilterCompany($event)">
                <option selected [ngValue]="invoiceSelectCustomerDef1">
                    {{invoice.customer.customerName}}
                </option>
                <option *ngFor="let opt of customers" [ngValue]="opt.getCustomerId()">
                    {{opt.customerName}}
                </option>
            </select>
            <br>
            <textarea readonly="readonly" name="message" rows="6" cols="100" [(ngModel)]="customerAdress"
                      placeholder="BspFirma&#x0a;Ansprechpartner&#x0a;Straße + HausNr.&#x0a;PLZ Ort&#x0a;Land">

          </textarea>
        </div><!-- class="adress-window" -->

        <div class="checkboxfield">
            <label><input type="checkbox" name="international" [checked]="invoice.invoiceKind.international"
                          (change)="changeInternational()"> Auslandsrechnung</label>
            <label><input type="checkbox" name="timeSpanBased" [checked]="invoice.invoiceKind.timeSpanBased"
                          (change)="changeTimeSpanBased()"> Zeitraumbasiert</label>
            <label><input type="checkbox" name="isSEPA" [checked]="invoice.invoiceKind.isSEPA"
                          (change)="changeIsSEPA()"> SEPA-Lastschriftmandat</label>
        </div>


        <div>

        </div>

        <div class="contact-block">
            <div class="logo">
                <img src="assets/logo.png" alt="SednaSoft" title="SednaSoft"/>
            </div><!-- class="logo" -->
            <strong>SednaSoft GbR</strong>
            <p>A. Schaffhirt & A. Wünsche</p>
            <p>Biesnitzer Straße 8</p>
            <p>02826 Görlitz</p>
            <p *ngIf="invoice.invoiceKind.international">GERMANY</p>
            <dl>
                <dt>Fon</dt>
                <dd>+49-3581-3221063</dd>
                <dt>Fax</dt>
                <dd>+49-3581-6858089</dd>
                <dt>Mail</dt>
                <dd>kontakt@sedna-soft.de</dd>
                <dt>Web</dt>
                <dd>http://sedna-soft.de</dd>
            </dl>
        </div><!-- class="contact-block" -->

    </header>


    <main>
        <section>
            <div class="city-date">Görlitz,
                <input type="date" name="inDate" [ngModel]="invoice.invoiceDate | date:'yyyy-MM-dd'"
                       (ngModelChange)="invoiceDateChange($event)">
            </div>

            <h1 class="invoice-number">Rechnung
                <input class="invoice-number" [ngModel]="invoice.invoiceNumber"
                       (ngModelChange)="invoiceNumberChange($event)">
            </h1>
            <!-- p>Zeitraum: 2018-01-01 bis 2018-12-31 (12 Monate)</p>
          <input class="timeSpan" class="inputLarge" [(ngModel)]="invoiceTimeSpan" -->
            <div class="timespan" *ngIf="invoice.invoiceKind.timeSpanBased">
                Zeitraum:
                <input type="date" name="inStartDate" [ngModel]="invoice.timespanBegin | date:'yyyy-MM-dd'"
                       (ngModelChange)="invoiceTimespanBeginChange($event)">
                bis
                <input type="date" name="inStartDate"
                       [ngModel]="invoice.timespanEnd ? (invoice.timespanEnd | date:'yyyy-MM-dd') : ''"
                       (ngModelChange)="invoiceTimespanEndChange($event)">
                {{timespan()}}
            </div>


            <div class="mobile-style">
                <!-- span *ngFor="let invoice of invoices" *ngIf="invoice.id === invoiceId" -->
                <table>
                    <!-- loop for all invoice - filter needed!!! -->
                    <thead>
                    <tr>
                        <th>Leistungsnummer</th>
                        <th>Leistungsbeschreibung</th>
                        <th>Leistungsdatum</th>
                        <th>Anzahl</th>
                        <th>Stückpreis</th>
                        <th>Gesamtpreis</th>
                        <th>Ändern</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr *ngFor="let item of invoice.items; let i = index">
                        <!-- loop for all items -->
                        <td>{{i + 1}}</td>
                        <td *ngIf="changedItemNumber !== i">{{item.itemName}}</td>
                        <td *ngIf="changedItemNumber === i"><input type="text" name="changedItem" size="70"
                                                                   [(ngModel)]="changedItem.itemName"
                                                                   placeholder="neue Leistungsbeschreibung"></td>
                        <td *ngIf="changedItemNumber !== i">{{item.itemDate}}</td>
                        <td *ngIf="changedItemNumber === i"><input type="text" name="changedItem" size="15"
                                                                   [(ngModel)]="changedItem.itemDate"></td>
                        <td *ngIf="changedItemNumber !== i">{{item.count}}</td>
                        <td *ngIf="changedItemNumber === i"><input type="text" name="changedItem" size="7"
                                                                   [(ngModel)] = "changedItem.count"
                                                                   (ngModelChange)="changeChangedItemCost()">

                        </td>
                        <!-- td>{{item.partialCost | number:'1.2-2'}}{{invoiceCurrency}}</td -->
                        <td *ngIf="changedItemNumber !== i">{{item.partialCostString(invoiceCurrency)}}</td>
                        <td *ngIf="changedItemNumber === i"><input type="text" name="changedItem" size="7"
                                                                   [(ngModel)]="changedItem.partialCost"
                                                                   (ngModelChange) = "changeChangedItemCost()">
                            <label>Stundenpreis</label>
                            <input type="checkbox" [(ngModel)] = "changedItem.hourPayment">
                            {{invoice.currency}}</td>
                        <td>{{item.count * item.partialCost | number:'1.2-2'}}{{invoiceCurrency}}</td>
                        <td>
                            <button *ngIf="changedItemNumber !== i" (click)="setChangeItemNumber(i)"
                                    [disabled]="changedItemNumber != '-1'">
                                Item bearbeiten
                            </button>
                            <button *ngIf="changedItemNumber === i" (click)="notSaveItem()">
                                zurück
                            </button>
                            <button *ngIf="changedItemNumber === i" (click)="saveItem()">
                                speichern
                            </button>
                            <!-- a routerLink="/item-detail/{{invoiceId}}/{{item.getItemId()}}">Posten bearbeiten</a-->
                        </td>
                    </tr>
                    </tbody>
                    <tfoot>

                    <tr>
                        <td colspan="4"></td>
                        <td>Summe Netto</td>
                        <td>{{invoice.wholeCost | number:'1.2-2'}}{{invoice.currency}}</td>
                    </tr>
                    <tr *ngIf="!invoice.invoiceKind.international">
                        <td colspan="4"></td>
                        <td>{{!invoice.invoiceKind.international ? percentageString : ''}} MwSt.</td>
                        <td> {{!invoice.invoiceKind.international ? (salesTax | number:'1.2-2') : 'Brutto == Netto '}}{{invoice.currency}}</td>
                        <td>
                            <button type="button">Mehrwertsteuer ändern</button>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="4"></td>
                        <td>Rechnungsbetrag</td>
                        <td> {{bruttoSum | number:'1.2-2'}}
                            <select name="invoiceCurrency" [(ngModel)]="invoice.currency">
                                <option value="€">€</option>
                                <option value="USD">USD</option>
                                <option value="GBP">GBP</option> <!-- Great -->
                                <option value="CZK">CZK</option>
                                <option value="PLN">PLN</option>
                                <option value="CHF">CHF</option>
                            </select>
                        </td>
                        <td>
                            <select name="invoiceState" [(ngModel)]="invoice.invoiceState">
                                <option value="Entwurf">Entwurf</option>
                                <option value="offen">offen</option>
                                <option value="teilweise bezahlt">teilweise bezahlt</option>
                                <option value="bezahlt">bezahlt</option>
                            </select>
                        </td>
                    </tr>
                    </tfoot>
                </table>
            </div>
            <button (click)="addNewItem()">Posten hinzufügen</button>
            <button (click)="saveInvoice()">{{(creatingInvoice || creatingInvoiceBtn) ? 'Create' : 'Save'}}</button>
            <button>cancel</button>
            <button (click)="backToInvoiceList()">zurück</button>
            <p></p>
            <div *ngIf="invoice.invoiceKind.international">
                <dl>
                    <dt>USt-IdNr.:</dt>
                    <dd>DE243517710</dd>
                    <dt>USt-IdNr. des Kunden:</dt>
                    <dd>
                        <input type="text" name="customerTaxNumber" size="27"
                               [(ngModel)]="invoice.customer.customerSalesTaxNumber">
                    </dd>
                </dl>
                <p>Steuerschuldnerschaft des Leistungsempfängers (Reverse Charge)</p>
            </div>
            <p></p>
            <div *ngIf="!invoice.invoiceKind.isSEPA">
                <p>Bitte überweisen Sie den Rechnungsbetrag bis zum
                    <input type="date" name="inDueDate" [ngModel]="invoice.invoiceDueDate | date:'yyyy-MM-dd'"
                           (ngModelChange)="invoiceDueDateChange($event)">
                    auf das unten angegebene Konto.</p>
                <p> Als Verwendungszweck geben Sie bitte
                    <input type="text" class="inputLarge" name="intendedUse" [(ngModel)]="invoice.invoiceIntendedUse">
                    an.</p>
            </div>
            <div *ngIf="invoice.invoiceKind.isSEPA">
                <p>Die Forderung von {{bruttoSum | number:'1.2-2'}}{{invoice.currency}} ziehen wir mit der SEPA
                    Basislastschrift
                    zum Mandat
                    <input type="text" name="mandateIdentification" size="27"
                           [(ngModel)]="invoice.customer.mandateIdentification">
                    zu der Gläubigeridentifikationsnummer {{creditorIdentificationNumber}}
                    von Ihrem Konto IBAN
                    <input type="text" name="customerIBAN" size="27" [(ngModel)]="invoice.customer.customerIBAN">
                    bei der Bank BIC
                    <input type="text" name="customerBIC" size="27" [(ngModel)]="invoice.customer.customerBIC">
                    zum Fälligkeitsdatum {{invoice.invoiceDueDate | date:'yyyy-MM-dd'}} ein. Wir bitten Sie,
                    für Kontodeckung zu sorgen.</p>
            </div>
        </section>
    </main>
    <footer>
        <div class="address">
            <p><strong>Adresse</strong></p>
            <p>SednaSoft GbR</p>
            <p>A.Schaffhirt & A.Wünsche</p>
            <p>Biesnitzer Straße 8</p>
            <p>02826 Görlitz</p>
            <p *ngIf="invoice.invoiceKind.international">GERMANY</p>
        </div>
        <div class="contact">
            <p><strong>Kontakt</strong></p>
            <dl>
                <dt>Fon</dt>
                <dd>+49-3581-3221063</dd>
                <dt>Fax</dt>
                <dd>+49-3581-6858089</dd>
                <dt>Mail</dt>
                <dd>kontakt@sedna-soft.de</dd>
                <dt>Web</dt>
                <dd>http://sedna-soft.de</dd>
            </dl>
        </div>
        <div class="bankconnection">
            <p><strong>Bankverbindung</strong></p>
            Commerzbank Dresden
            <dl>
                <dt>BIC</dt>
                <dd>DRESDEFF850</dd>
                <dt>IBAN</dt>
                <dd>DE56 8508 0000 0265 0770 01</dd>
            </dl>
        </div>
        <div class="tax-number">
            <p><strong>USt-IdNr.</strong></p>
            <p>DE243517710</p>
        </div>
    </footer>
</div>
